





## Week 1

### 1.Intro

![Screenshot 2020-10-26 at 15.36.24](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 15.36.24.png)



![Screenshot 2020-10-26 at 15.38.25](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 15.38.25.png)

![Screenshot 2020-10-26 at 15.52.20](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 15.52.20.png)



![Screenshot 2020-10-26 at 15.51.24](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 15.51.24.png)



![Screenshot 2020-10-26 at 15.54.44](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 15.54.44.png)



![Screenshot 2020-10-26 at 16.03.31](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 16.03.31.png)

![Screenshot 2020-10-26 at 16.25.44](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 16.25.44.png)

![Screenshot 2020-10-26 at 16.26.59](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 16.26.59.png)

![Screenshot 2020-10-26 at 16.30.22](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 16.30.22.png)



### 2.Classical

![Screenshot 2020-10-26 at 19.55.33](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 19.55.33.png)



![Screenshot 2020-10-26 at 19.57.23](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 19.57.23.png)

![Screenshot 2020-10-26 at 19.58.21](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 19.58.21.png)

![Screenshot 2020-10-26 at 19.59.12](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 19.59.12.png)

![Screenshot 2020-10-26 at 20.01.03](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 20.01.03.png)

![Screenshot 2020-10-26 at 23.17.15](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.17.15.png)

![Screenshot 2020-10-26 at 23.18.29](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.20.01.png)

![Screenshot 2020-10-26 at 23.21.29](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.21.29.png)



![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)



![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.34.50](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.34.50.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.37.16](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.37.16.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.38.41](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.39.03.png)

![Screenshot 2020-10-26 at 23.40.59](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.40.59.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.27.43.png)

![Screenshot 2020-10-26 at 23.42.13](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.42.13.png)

![Screenshot 2020-10-26 at 23.42.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-26 at 23.42.43.png)

[How Playfair Works](https://www.youtube.com/watch?v=quKhvu2tPy8)



![Screenshot 2020-10-26 at 23.27.43](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 00.11.06.png)

![Screenshot 2020-10-27 at 00.12.13](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 00.12.13.png)

![Screenshot 2020-10-27 at 00.13.14](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 00.13.14.png)

![Screenshot 2020-10-27 at 00.14.12](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 00.14.12.png)

[How vigenere cipher works](https://www.youtube.com/watch?v=SkJcmCaHqS0)

![Screenshot 2020-10-27 at 22.20.07](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.20.07.png)

![Screenshot 2020-10-27 at 22.22.15](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.22.15.png)

![Screenshot 2020-10-27 at 22.23.40](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.23.40.png)

![Screenshot 2020-10-27 at 22.25.41](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.25.41.png)

![Screenshot 2020-10-27 at 22.29.37](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.29.37.png)

![Screenshot 2020-10-27 at 22.29.37](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.29.37.png)

![Screenshot 2020-10-27 at 22.31.34](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.31.34.png)

![Screenshot 2020-10-27 at 22.33.38](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.33.38.png)

![Screenshot 2020-10-27 at 22.35.51](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.35.51.png)

[Introduction of Rail Fence and route Cipher](https://www.youtube.com/watch?v=0um-_4SvPg0)

![Screenshot 2020-10-27 at 22.42.00](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.42.00.png)

The ciphers of Transposition can be easy decrypted if you know the rule.

![Screenshot 2020-10-27 at 22.44.54](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.44.54.png)

### 3.Enigma

![Screenshot 2020-10-27 at 22.45.59](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.45.59.png)





[Enigma Machine](https://www.youtube.com/watch?v=ASfAPOiq_eQ)

The other side should know the algorithm, two machine should be set up in the same way. The three gears should be placed at the same place at the begining.

Every month you should have a paper to tell each other how to set up the machine.

The key may be lost, because during war II , you need some guys to deliver it.

![Screenshot 2020-10-27 at 22.56.39](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 22.56.39.png)

![Screenshot 2020-10-27 at 23.00.16](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-27 at 23.00.16.png)

![Screenshot 2020-10-28 at 21.40.03](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-28 at 21.40.03.png)



![Screenshot 2020-10-30 at 10.26.41](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-30 at 10.26.41.png)

[How to break Enigma](https://www.youtube.com/watch?v=V4V2bpZlqx8)

The original enigma machine will never translate a character to itself, only to other 25 character. So it is the flaw of original enigma machine.

Turing designed a bombe machine to break enigma within 20 minutes.

![Screenshot 2020-10-30 at 10.39.55](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-10-30 at 10.39.55.png)

Bombe machine is built under a process of elimination

**what you're left with is what wasn't wrong!**



how to develop the original Enigma machine?

**make it possible to translate the charater to itself.**



## Week 2

### 1.DES



Feistel Cipher

[Feistel Cipher](https://www.youtube.com/watch?v=FGhj3CGxl8I)

![image-20201103174514678](/Users/guohuanjie/Library/Application Support/typora-user-images/image-20201103174514678.png)

![Screenshot 2020-11-03 at 18.11.22](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-03 at 18.11.22.png)

![Screenshot 2020-11-03 at 18.16.00](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-03 at 18.16.00.png)

![image-20201103181942067](/Users/guohuanjie/Library/Application Support/typora-user-images/image-20201103181942067.png)

![Screenshot 2020-11-03 at 18.22.36](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-03 at 18.22.36.png)



![Screenshot 2020-11-03 at 18.35.33](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-03 at 18.35.33.png)

![Screenshot 2020-11-03 at 18.37.56](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-03 at 18.37.56.png)

![Screenshot 2020-11-03 at 18.40.12](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-03 at 18.40.12.png)

symmetry (stream cipher、block cipher)

[Des](https://www.youtube.com/watch?v=kPBJIhpcZgE)

#### 1.Introduction

1974   by IBM    input from NSA

1977...1998  US Standard

best studied cipher in the world

unsecure today( the key too short)

but 3DES is very secure

![Screenshot 2020-11-05 at 23.24.00](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-05 at 23.24.00.png)

Q: How do we build a block cipher?

Shannon:  two atomic operations

1. **Confusion**: Relationship between plain & ciphertext is obscured( hard to understand)

   

2. **Diffusion**: The influence of one each plaintext bit is spread over many ciphertext bits. (input change a bit, output change many bits)

combine confusion & diffusion many times to build a strong block cipher.

![Screenshot 2020-11-05 at 23.45.06](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-05 at 23.45.06.png)

"product cipher"

#### 2. inside the DES

how DES algorithm work!



**Feistel**

![Screenshot 2020-11-05 at 23.58.37](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-05 at 23.58.37.png)

**left side** is encrypted using an **XOR** operation!   ( 1 XOR 0 = 1; 1 XOR 1 = 0; 0 XOR 0 = 0)



Detail of the F-**Function**

![Screenshot 2020-11-06 at 19.50.09](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 19.50.09.png)

![Screenshot 2020-11-06 at 18.12.50](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 18.12.50.png)

**Extension-Box (E)** provides defusion.

![Screenshot 2020-11-06 at 18.18.06](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 18.18.06.png)

**4n and 4n+1 to provide two outputs**. and others provide only one!



**S-Box**  The "heart" of DES!  provides confusion

![Screenshot 2020-11-06 at 19.31.15](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 19.31.15.png)

unusual decoding of the S-box tables.

![Screenshot 2020-11-06 at 19.35.15](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 19.35.15.png)

![Screenshot 2020-11-06 at 19.38.28](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 19.38.28.png)

where does the table come from?

from IBM...

people worry that there are some mathematical  tricks behind the table and IBM can use it to break your text.

Search that from the tabel,  xxxx search the col and xx search the row.

![Screenshot 2020-11-06 at 19.40.07](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 19.40.07.png)

**Differential Cryptanalysis** can break the DES by using the S table!  But IBM know that 15 years ago and they would like to keep it as a secret.



IP and IP^-1

-> simple bit permutation

![Screenshot 2020-11-06 at 17.48.12](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 17.48.12.png)



#### 3.Des Key scheducle

How to compute the 16 subkey  k1 ... k16?

a)=> drops bits 8,16,24 ... 64

=>effctive key length of DES is 64 - 8 = 56 bits

![Screenshot 2020-11-06 at 20.50.01](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 20.50.01.png)



### 2.Finite Field

#### 1.Motivation -AES

![Screenshot 2020-11-06 at 22.49.32](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-06 at 22.49.32.png)

all internal operations of AES are based on finite Field

#### 2. Introduction to Finite Fields

Finite field = Galois field 

3 basic algebraic structures

very informally "A field is a set of numbers in which we can add, subtract, multiply and divide"

![Screenshot 2020-11-07 at 16.03.28](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 16.03.28.png)

#### 3. Prime Fileds Arithmetic

The elements of a prime field GF(p) are the integrers {0,1,...,p-1}.



a) Add, subtract, multiply

![Screenshot 2020-11-07 at 17.33.09](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 17.33.09.png)

b) inversion

![Screenshot 2020-11-07 at 17.36.54](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 17.36.54.png)

#### 4.Extention Field GF(2^m)

Arithmetic

a) Element representation

The elements of GF(2^m) are polynomials.

![Screenshot 2020-11-07 at 17.46.49](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 17.46.49.png)

![Screenshot 2020-11-07 at 17.50.39](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 17.50.39.png)

Q. how to compute wl these elements?

b) Addition and Subtraction in GF(2^m)

=> use regular polynomial addtion or subtraction, where the conficient are computed in GF(2) 



Ex GF(2^3)

A(X) = x^2+x+1

B(x) = X^2 +1

**A+B = (1+1)x^2+x+(1+1) = 0x^2+x+0 = x**

Note : Add and Sub in GF(2m) are the **same** operations.



c)Mutiplication in GF(2^m)

intuition: just do regular polynomial multi



Ex GF(2^3)

A*B = (x^2+x+1)(x^2+1) = x^4+x^3+x^2+x^2+x+1 =  x^4+x^3+x+1 = C'(x)



recall prime fields

Ex. GF(7) = {0,1....6}

3*4 = 12 恒等于 5 mod 7



solution: Reduce c'(x) module a polynomial that 'behaves like a prime'. These are called irreducible polynomails.

Irreducible polynomial for GF(2^3)

P(x) = x^3 +x +1

![Screenshot 2020-11-07 at 18.26.03](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 18.26.03.png)

For every Field GF(2^m) there are several irr polynomials.

Ex P(x) = X^3 + X^2 +1



The "AES irreducible polynomial" 

P(x) = x^8 +x^4 +x^3+x+1



d) inversion in GF(2^m)

the inverse A^-1(x) of an elt A(x)属于GF(2ams ^m) must satisfy

**A(x)*A(x)^-1 恒等于 1 mod P(x)**



### 3. AES (Advanced Encrypted Standard)

#### 1.Introduction to AES

brief history

1997 (When DES was attacked)  - call for AES by NIST

Aug 1998 15  algorithm submissions 

Aug 1999  5 Finalist Algorithms are selected.

Oct 2, 2000 Rijndael was chosen as the AES

designer: Joan Daemen  & Vincent Rijmen

very high level view 

![Screenshot 2020-11-07 at 19.19.07](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 19.19.07.png)

number of rounds depend on the key length

![Screenshot 2020-11-07 at 19.21.10](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 19.21.10.png)、



Remarks

1) AES is by now the most important symmetric algorithm in the world.

2) NSA allows AES for classified data up to top secret with 192/256 bit key.



#### Structure of AES

![Screenshot 2020-11-07 at 19.43.59](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 19.43.59.png)

AES is **not** a Feistel cipher

AES encrypts all 128 bits of the data path in 1 round



Remarks

- each round consists of 4 layers

  1) ByteSub   -> provides confusion

  2) ShiftRow     -> diffusion

  3) MixCol        -> diffusion

  4) Key Addition

- last round does not have the MixCol layer

- at the begining of AES and at the very end a subkey is added "key whitening"

  

Q: what happens inside the layers?

![Screenshot 2020-11-07 at 20.11.31](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 20.11.31.png)

note: the 128bit data path is split into 16 bytes(16 * 8)!

![Screenshot 2020-11-07 at 20.28.49](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 20.28.49.png)



3a)  Byte Substitution Layer

"S-Box Layer"

S(Ai) = Bi

all 16 S-boxs are identical.

![Screenshot 2020-11-07 at 22.41.47](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 22.41.47.png)



EX. Ai = C2.16(X,Y) = (1100,0010) = search from table

Bi = S(Ai)  = 25(from table) = 0010 0101

![Screenshot 2020-11-07 at 22.28.37](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 22.28.37.png)



Q: How is the S-Box table constructed?

consider Ai->GF(2^8) and compute its inverse



Ex.   Ai = 1100 0010

Ai(x) = x^7+x^6+x

Bi'(x) = x^5 + x^3+x^2+x+1 = A^-1(x)

Bi' = 0010 1111



(x^7+x^6+x) ~(x^5+x^2+1) =  1 mod (x^8+x^4+x^3+1)

​     A(x)              B'(x) = A^-1(x)               AES irr Pol.



![Screenshot 2020-11-07 at 22.42.58](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 22.42.58.png)



you can just use the table, the calculation above is the process of how the table produce.

3b)  Shift Rows Layer

vary systematic if we write the state (i.e, the 16 byte of the data path) as a 4 * 4 matrix.

![Screenshot 2020-11-07 at 22.50.33](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 22.50.33.png)

3c) MixColumn 

Ex.  1st mixCol box

![Screenshot 2020-11-07 at 22.59.14](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-07 at 22.59.14.png)

Tips: 02 and 03 position, the rest are all 01 (Mathematic)

Remind: all Bi,Ci and constans are bytes

C0 = 02~B0+03~B5+01~B10+01~ B15(~ mutiply) 

​        GF(2^8)

Q: what are 01,02,03?

A: 01 =0000 0001 <-> GF(2^8)

02 = 0000 0010 <-> x

03 = 0000 0011 <-> x+1



### 4.Public Key

#### 1.Pesudorandom number generator

produce by seed

same seed, same sequence

the length of the seed is so important

pesudorandom number : would repeat in the end.

##### 1.middle square algorithm



![Screenshot 2020-11-14 at 00.22.25](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 00.22.25.png)



Xn+1 = (*aX*n + *c*) mod *m*

![Screenshot 2020-11-14 at 00.23.51](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 00.23.51.png)

use three dices to produce 3-18, is a normal distribution

![Screenshot 2020-11-14 at 00.25.34](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 00.25.34.png)

n = (seed * seed) ->"0" + substring-> last 8 digest ->middle 4 digit -> seed



![Screenshot 2020-11-14 at 16.11.51](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 16.11.51.png)

good at the begining, and then no random, not a good PRNG Algorithm



##### 2.Linear Congruential Generator

![Screenshot 2020-11-14 at 16.36.04](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 16.36.04.png)



when parameter(a seed c) is not suitable! (repeat)

![Screenshot 2020-11-14 at 16.36.45](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 16.36.45.png)



when parameter is good enough

![Screenshot 2020-11-14 at 16.43.54](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 16.43.54.png)





#### 2. NumThy

##### 1.Fermat's theorem

![Screenshot 2020-11-14 at 17.59.51](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 17.59.51.png)

##### 2.Prime Factorization

Prime number <-> Composite number

GCD( Greatest Common Divisor )



##### 3. Discrete logarithm

easy to calculate

3^5 mod 17 = ? 



hard to calculate

![Screenshot 2020-11-14 at 22.20.32](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 22.20.32.png)



#### 3. Public Key Function

##### 1. Key Exchange(Diffifie-Hellman)

![Screenshot 2020-11-14 at 22.30.42](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 22.30.42.png)

![Screenshot 2020-11-14 at 22.54.26](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 22.54.26.png)

The function is 3^x mod 17

1. rlice: select 15 -> 3^15 mod 17 = 6 -> send 6 to bob( eve now have 6)

2. bob: select 13 -> 3^13 mod 17 = 12 -> sent 12 to Rlice (eve have 6 and 12)

3. Alice : 12^15 mod 17 = 10  => (3^13)^15 mod 17

   Bob :   6^13 mod 17 = 10 => (3^15)^13 mod 17
   
   

##### 2.Encryption and signature(using ElGamal)

###### 1.Encryption

### ![Screenshot 2020-11-16 at 22.29.27](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 22.29.27.png)

​          q     prime number

​          a    a<q and a a primitive root of q.

1. **Alice**

   Select private (X.A)        (X.A) < q-1

   Calculator (Y.A)          (Y.A) = a^(X.A) mod q

   Public Key                     PU = {q,a,(Y.A)}

   Private Key                   X.A

2. **Encryption by Bob with Alice's Public Key**

   Plaintext											M<q

   Select random integer k 				k<q

   Calculate K(one time)					K = (Y.A)^k mod q

   Calculate C1(D- H)						C1 = a^k mod q

   Calculate C2									C2 = KM mod q

   Ciphertext										(C1,C2)

3. **Decryption by Alice with Alice's Private Key**

   Ciphertext								(C1,C2)

   Calculate K								K = C1^(X.A) mod q

   Plaintext									M = (C2(K^(-1)) mod q

###### 2.Signature

q     prime number

 a    a<q and a a primitive root of q.

**Alice**

Select private (X.A)        (X.A) < q-1

Calculator (Y.A)          (Y.A) = a^(X.A) mod q

Public Key                     PU = {q,a,(Y.A)}

Private Key                   X.A

Plaintext						M - > Hash(M) (0<m<=q-1)

1.   select  random k (1<=k<=q-1)
2.   S1=  a^k mod q
3.  calculate K = k^(-1) mod (q-1)
4.  S2 =K* (m-X.A*S1) mod (q-1)
5. (S1,S2) - > Signature pair

**Bob**

v1 = a^m mod q

v2 = (Y.A)^(S1)*(S1)^(S2) mod q

(v1 = v2) -> Signature is valid



##### 3. Elliptic Curves Cryptography

shorter  encryption keys use fewer memory and CPU resources.

y^2 = x^3+ax+b （4a^3+27b^2 != 0）



![Screenshot 2020-11-21 at 10.58.09](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-21 at 10.58.09.png)



![v2-8d11ab14dddaef7b3877751b78775f75_720w](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/v2-8d11ab14dddaef7b3877751b78775f75_720w.jpg)

P+R+Q = 0  -> P+Q =  -R

when the straight line move, only two point on the curve, one of the point is the pointcut(切点)

![Screenshot 2020-11-21 at 11.51.55](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-21 at 11.51.55.png)

P + P = -R. (P=Q)

![Screenshot 2020-11-21 at 11.53.35](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-21 at 11.53.35.png)

P+Q = -Q

------

(x.p!=x.q)    m = (y.p-y.q)/(x.p-x.q)

x.r = m^2 - x.p-x.q

y.r = y.p+m(x.r-x.p) ] ]

-> (x.p,y.p) + (x.q,y.q) = (x.r,-y.r)  （P+Q = - R）



###### 1.DF exchange



### 5. RSA

1.random get two long digits number p1 and p2, (p1 and p2 is prime)

n = p1 * p2 (hide it)

![Screenshot 2020-11-14 at 23.53.02](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 23.53.02.png)

**tips:   phi of any prime is easy to compute !** phi(7) = 7-1

![Screenshot 2020-11-14 at 23.54.23](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 23.54.23.png

![Screenshot 2020-11-14 at 23.55.15](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 23.55.15.png)

![Screenshot 2020-11-14 at 23.56.23](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-14 at 23.56.23.png)



**How does RSA work**

![Screenshot 2020-11-16 at 12.43.07](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.43.07.png)

![Screenshot 2020-11-16 at 12.58.51](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.58.51.png)

![Screenshot 2020-11-16 at 12.59.24](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.59.24.png)



public key = (e,n)

private key = (d,n)

![Screenshot 2020-11-16 at 12.51.49](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.51.49.png)

for example : 9^phi(3) = 1 mod 2

becasue 1^k = 1

![Screenshot 2020-11-16 at 12.53.51](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.53.51.png)

![Screenshot 2020-11-16 at 12.54.29](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.54.29.png)

![Screenshot 2020-11-16 at 12.54.56](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.54.56.png)

![Screenshot 2020-11-16 at 12.55.30](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.55.30.png)

![Screenshot 2020-11-16 at 12.47.29](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-16 at 12.47.29.png)

**k is the number which can make d as a Long**



### 6. Hash

------

**Hash Function**

 A hash function maps arbitrary strings of data to fiexed length output .

it should be deterministic, public, "random"

h: {0,1}^x -> {0,1}^d  output length d.

poly-time computation 

MD4, MD5 -> 128 bits output

SHA-1 -> 160 bits

SHA-3   current recommended algorithm. (Too complicated and too slow, heavyweight)



Ideal: **Random Oracle**



OW: **one-way** (pre-image resistance)

Infeasible, given y->{0,1}^d to find any x . h(x) = y.



CR: **Collision Resistance**

"Collision" infeasible to find x,x'  (x!=x'), and h(x) = h(x')



 TCR:  **Target collision resistance**

Infeasible  given x, to find x' != x. h(x) = h(x')



**Pseudo-randomness**



NM: **Non Malleability**(可展性；适应性) 

Infeasible given h(x) to produce h(x') where x and x' are "related". eg. x'=x+1



h is CR => h is TCR (but not reverse)



attention： birthday attract!   it requrie to have a longer output of hash func.



------

**Sha1**

sha1 -> 160 bit long

repeat - > choose 512 bit at a time until the file's expended.

![Screenshot 2020-11-21 at 12.44.39](/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-21 at 12.44.39.png)

32 * 5 

if your input is less than 512 bits, 

1011101(length 111)         - >   1011101[10000....00111]  

10111(length101)  -> 10111[1000...00101]       





------

### 10.Quantum Cryptography

<img src="/Users/guohuanjie/Documents/UoM Learning/COMP61411 Cryptography/image/Screenshot 2020-11-26 at 23.12.36.png" alt="Screenshot 2020-11-26 at 23.12.36" style="zoom: 67%;" />

Anyone who want to detect the key will leaves a trace, so we can know that if it is secured. 

